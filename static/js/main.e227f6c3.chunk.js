(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{106:function(e,t){},111:function(e,t,a){},113:function(e,t,a){},114:function(e,t,a){},115:function(e,t,a){},116:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(22),l=a.n(r),c=a(6),i=a(7),o=a(5),u=a(9),d=a(8),m=(a(75),a(65)),h=a(16),p=a(12),f=(a(76),a(118)),g=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"copyToClipboard",value:function(e){navigator.clipboard.writeText(e.currentTarget.getAttribute("data-channelid"))}},{key:"render",value:function(){return s.a.createElement(s.a.Fragment,null,s.a.createElement(h.a,{className:"channelInfo"},s.a.createElement(p.a,{xs:12},s.a.createElement(h.a,null,s.a.createElement(p.a,{lg:9,xs:7},s.a.createElement("div",null,s.a.createElement("h4",null,s.a.createElement("span",null,this.props.currentChat.chatname)))),s.a.createElement(p.a,{lg:3,xs:5},s.a.createElement("div",{className:"link","data-channelid":this.props.currentChat.chatid,onClick:this.copyToClipboard},s.a.createElement("h4",null,s.a.createElement(f.a,{variant:"secondary"},"Copy Link"))))))))}}]),a}(s.a.Component),v=a(21),E=a(121),y=a(60),b=a.n(y)()("https://infinite-mountain-27413.herokuapp.com/"),C=function(){function e(){Object(c.a)(this,e)}return Object(i.a)(e,null,[{key:"registerUser",value:function(e,t){b.emit("register",{username:e,password:t})}},{key:"loginUser",value:function(e,t){b.emit("login",{username:e,password:t})}},{key:"authListener",value:function(e){b.on("authorize",(function(t){var a="login"===t.type;a&&t.userid?(delete t.type,b.id=t.userid,e(t)):a?alert("Wrong credentials. Try again."):t.userid?(delete t.type,b.id=t.userid,e(t)):alert("account already exist")}))}},{key:"getSocketId",value:function(){return b.id}},{key:"setSocketId",value:function(e){b.id=e}},{key:"forceNoSuchChannelAlert",value:function(){b.on("nosuchchannel",(function(e){alert("No such channel: "+e.channelid)}))}},{key:"newChannelListener",value:function(e){b.on("newChannel",(function(t){e(t)}))}},{key:"loadChannelsListener",value:function(e){b.on("loadChannels",(function(t){t.forEach((function(t){e(t)}))}))}},{key:"emitConnectToChannel",value:function(e){b.emit("connectToChannel",{channelid:e})}},{key:"emitAddNewChannel",value:function(e){b.emit("addChannel",{channelName:e})}},{key:"emitReadyToLoadChannelsState",value:function(){b.emit("readyToLoadChannels")}},{key:"receiveMessage",value:function(e){b.on("broadcastMessage",(function(t){b.id===t.from.userid&&(t.isMe=!0),e(t)}))}},{key:"emitLoadMessages",value:function(e){b.emit("load messages",{channelid:e})}},{key:"loadMessagesListener",value:function(e){b.on("load messages",(function(t){t.forEach((function(t){b.id===t.from.userid&&(t.isMe=!0),e(t)}))}))}},{key:"emitSendMessage",value:function(e,t){console.log(e,b.id),b.emit("message",{channelid:e,message:t,datetime:(new Date).toString()})}},{key:"loadActiveUsers",value:function(e){b.emit("getConnectedUsers",{channelid:e}),b.on("fullUpdatePanel",(function(){b.emit("getConnectedUsers",{channelid:e})}))}},{key:"usersPanelListener",value:function(e){b.on("loadUsersOnPanel",(function(t){e(t)}))}},{key:"needUpdateListener",value:function(e){b.on("updatePanel",(function(){console.log("forced to update panel"),b.emit("updateActiveUsers",{channelid:e})}))}},{key:"updateActiveUsers",value:function(e){b.on("activeUsers",(function(t){e(t)}))}}]),e}(),k=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).addMessage=n.addMessage.bind(Object(o.a)(n)),n.scrollToBottom=n.scrollToBottom.bind(Object(o.a)(n)),n.state={messageList:[]},n.messageField=s.a.createRef(),n}return Object(i.a)(a,[{key:"addMessage",value:function(e){if(this.props.chatId==e.channelid){var t={span:6,offset:0},a={span:10,offset:0};e.isMe&&(t.offset=6,a.offset=2);var n=new Date(e.datetime),r="".concat(n.getHours(),":").concat(n.getMinutes()),l=r+"\t ".concat(n.getDate(),".").concat(n.getMonth(),".").concat(n.getFullYear());this.setState((function(n){return{messageList:[].concat(Object(v.a)(n.messageList),[s.a.createElement(h.a,{key:e.datetime+e.message,className:"my-2"},s.a.createElement(p.a,{lg:t,xs:a,className:"messageRow w-100 d-flex justify-content-center"},s.a.createElement(E.a,{style:{minWidth:"250px"}},s.a.createElement(E.a.Header,{title:e.from.username},s.a.createElement("strong",{className:"mr-auto"},e.from.username),s.a.createElement("small",{title:l},r)),s.a.createElement(E.a.Body,null,e.message))))])}}))}}},{key:"scrollToBottom",value:function(){this.messageField.current.scrollTo(0,this.messageField.current.scrollHeight)}},{key:"componentDidMount",value:function(){C.receiveMessage(this.addMessage),C.emitLoadMessages(this.props.chatId),C.loadMessagesListener(this.addMessage),this.scrollToBottom()}},{key:"componentDidUpdate",value:function(){this.scrollToBottom()}},{key:"render",value:function(){return s.a.createElement(s.a.Fragment,null,s.a.createElement(h.a,{className:"chatField hideScrollBar py-5",ref:this.messageField},s.a.createElement(p.a,{md:12},this.state.messageList)))}}]),a}(s.a.Component),O=a(119),j=a(64),N=(a(111),function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).inputHandler=n.inputHandler.bind(Object(o.a)(n)),n.keyPressed=n.keyPressed.bind(Object(o.a)(n)),n.sendHandler=n.sendHandler.bind(Object(o.a)(n)),n.state={message:""},n.inputField=s.a.createRef(),n}return Object(i.a)(a,[{key:"inputHandler",value:function(e){e.persist(),this.setState({message:e.target.value})}},{key:"keyPressed",value:function(e){13==e.keyCode&&(e.preventDefault(),this.state.message.length>0&&(this.props.enterHandler(this.state.message.trim()),e.target.value="",this.setState({message:""})))}},{key:"sendHandler",value:function(){this.state.message.length>0&&(this.inputField.current.value="",this.props.enterHandler(this.state.message),this.setState({message:""}))}},{key:"render",value:function(){return s.a.createElement(s.a.Fragment,null,s.a.createElement(O.a,{className:"mb-2 py-2"},s.a.createElement(j.a,{ref:this.inputField,className:"formControlMessage",type:"text",placeholder:this.props.inputPlaceHolder,onChange:this.inputHandler,onKeyDown:this.keyPressed,value:this.state.message}),s.a.createElement(O.a.Append,{className:"sendMessageButton",onClick:this.sendHandler},s.a.createElement(O.a.Text,null,this.props.buttonName))))}}]),a}(s.a.Component)),L=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).onEnterInputHandler=n.onEnterInputHandler.bind(Object(o.a)(n)),n}return Object(i.a)(a,[{key:"onEnterInputHandler",value:function(e){C.emitSendMessage(this.props.chatId,e)}},{key:"render",value:function(){return s.a.createElement(s.a.Fragment,null,s.a.createElement(h.a,{className:"messageField"},s.a.createElement(p.a,{md:12,className:"px-0"},s.a.createElement("div",{className:"messageInputBox"},s.a.createElement(N,{inputPlaceHolder:"Your message",buttonName:"Send",enterHandler:this.onEnterInputHandler})))))}}]),a}(s.a.Component),w=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={message:"",incomingMessage:""},n.chatBody=s.a.createRef(),n}return Object(i.a)(a,[{key:"render",value:function(){return s.a.createElement(s.a.Fragment,null,s.a.createElement(g,{currentChat:this.props.currentChat}),s.a.createElement(k,{chatId:this.props.currentChat.chatid,key:this.props.currentChat.chatid}),s.a.createElement(L,{chatId:this.props.currentChat.chatid}))}}]),a}(s.a.Component),H=a(18),U=a(17),M=(a(113),function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).addChannel=n.addChannel.bind(Object(o.a)(n)),n.clickOnChannel=n.clickOnChannel.bind(Object(o.a)(n)),n.state={channelList:[]},n}return Object(i.a)(a,[{key:"createNewChannel",value:function(e){C.emitAddNewChannel(e)}},{key:"connectToChannel",value:function(e){C.emitConnectToChannel(e)}},{key:"addChannel",value:function(e){var t=this;this.setState((function(a){return{channelList:[].concat(Object(v.a)(a.channelList),[s.a.createElement(h.a,{className:"chatRoom","data-channelid":e.channelId,"data-channelname":e.channelName,key:e.channelId,onClick:t.clickOnChannel},s.a.createElement(p.a,{md:12},s.a.createElement("span",null,e.channelName)))])}}))}},{key:"clickOnChannel",value:function(e){this.props.changeChat(e.currentTarget.getAttribute("data-channelid"),e.currentTarget.getAttribute("data-channelname"))}},{key:"componentDidMount",value:function(){C.forceNoSuchChannelAlert(),C.newChannelListener(this.addChannel),C.loadChannelsListener(this.addChannel),C.emitReadyToLoadChannelsState()}},{key:"render",value:function(){return s.a.createElement("div",{id:"channelWrapper"},s.a.createElement(h.a,{className:"createRoom"},s.a.createElement(p.a,{md:12,className:"px-0 mb-0"},s.a.createElement(U.a,null,s.a.createElement(H.a,null,s.a.createElement(U.a.Toggle,{as:H.a.Header,eventKey:"0"},"Create chat-channel"),s.a.createElement(U.a.Collapse,{eventKey:"0"},s.a.createElement(H.a.Body,null,s.a.createElement(N,{inputPlaceHolder:"Channel name",buttonName:"Create",enterHandler:this.createNewChannel}))))))),s.a.createElement(h.a,{className:"connectToRoom"},s.a.createElement(p.a,{md:12,className:"px-0 mb-0"},s.a.createElement(U.a,null,s.a.createElement(H.a,null,s.a.createElement(U.a.Toggle,{as:H.a.Header,eventKey:"0"},"Connect to chat room"),s.a.createElement(U.a.Collapse,{eventKey:"0"},s.a.createElement(H.a.Body,null,s.a.createElement(N,{inputPlaceHolder:"Channel link",buttonName:"Connect",enterHandler:this.connectToChannel}))))))),s.a.createElement(h.a,{className:"lineBorder"},s.a.createElement(p.a,{md:12})),this.state.channelList)}}]),a}(s.a.Component)),S=(a(114),function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).updateUsersList=n.updateUsersList.bind(Object(o.a)(n)),n.updateActivityStateInPanel=n.updateActivityStateInPanel.bind(Object(o.a)(n)),n.drawUserList=n.drawUserList.bind(Object(o.a)(n)),n.state={userList:[]},n}return Object(i.a)(a,[{key:"drawUserList",value:function(){var e=[];return this.state.userList.forEach((function(t){e.push(s.a.createElement("li",{className:"list-group-item list-group-item-".concat(t.isActive?"secondary":"light"),key:t.userid,title:t.isActive?"Now online":"Now inactive"},t.username))})),e}},{key:"updateUsersList",value:function(e){this.setState({userList:e})}},{key:"updateActivityStateInPanel",value:function(e){var t=Object(v.a)(this.state.userList);t=t.map((function(t){return e[t.userid]?t.isActive=!0:t.isActive=!1,t})),this.setState({userList:t})}},{key:"componentDidMount",value:function(){C.loadActiveUsers(this.props.chatid),C.usersPanelListener(this.updateUsersList),C.needUpdateListener(this.props.chatid),C.updateActiveUsers(this.updateActivityStateInPanel)}},{key:"render",value:function(){var e=this.drawUserList(this.state.userList);return s.a.createElement(s.a.Fragment,null,s.a.createElement(h.a,null,s.a.createElement(p.a,{xs:12,className:"panelHeader"},s.a.createElement("span",null,s.a.createElement("h4",null,"Users on channel")))),s.a.createElement(h.a,{className:"usersPanel"},s.a.createElement(p.a,{xs:12},s.a.createElement("ul",{className:"list-group "},e))),s.a.createElement(h.a,{className:"streamPanel"},s.a.createElement(p.a,{xs:12})))}}]),a}(s.a.Component)),I=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).chooseChatChannel=n.chooseChatChannel.bind(Object(o.a)(n)),n.state={currentChat:{chatid:"generalchatid",chatname:"General Chat"}},n}return Object(i.a)(a,[{key:"chooseChatChannel",value:function(e,t){this.setState({currentChat:{chatid:e,chatname:t}})}},{key:"render",value:function(){return s.a.createElement(m.a,{fluid:!0,className:"h-100"},s.a.createElement(h.a,{className:"main"},s.a.createElement(p.a,{sm:3,className:"aside hideScrollBar"},s.a.createElement(M,{credentials:this.props.credentials,changeChat:this.chooseChatChannel})),s.a.createElement(p.a,{sm:6,className:"middlePanel mx-1"},s.a.createElement(w,{credentials:this.props.credentials,currentChat:this.state.currentChat})),s.a.createElement(p.a,{sm:2},s.a.createElement(S,{chatid:this.state.currentChat.chatid,key:this.state.currentChat.chatid}))))}}]),a}(s.a.Component),T=a(66),x=a(120),A=a(122),P=(a(115),function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).inputHandler=n.inputHandler.bind(Object(o.a)(n)),n.login=n.login.bind(Object(o.a)(n)),n.register=n.register.bind(Object(o.a)(n)),n.state={userName:"",password:""},n}return Object(i.a)(a,[{key:"inputHandler",value:function(e){e.persist(),this.setState(Object(T.a)({},e.target.getAttribute("data-inputtype"),e.target.value))}},{key:"register",value:function(){this.state.userName&&this.state.password?C.registerUser(this.state.userName,this.state.password):console.log("not authed")}},{key:"login",value:function(){this.state.userName&&this.state.password?C.loginUser(this.state.userName,this.state.password):console.log("not authed")}},{key:"componentDidMount",value:function(){C.authListener(this.props.setCredentials)}},{key:"render",value:function(){return s.a.createElement(m.a,{fluid:!0,className:"h-100"},s.a.createElement(h.a,{className:"h-50 pt-5"},s.a.createElement(p.a,{md:{span:8,offset:2},id:"authCard"},s.a.createElement(h.a,null,s.a.createElement(p.a,{md:12,className:"d-flex justify-content-center"},s.a.createElement("h3",null,"\u0410\u0432\u0442\u043e\u0440\u0438\u0437\u0443\u0439\u0442\u0435\u0441\u044c"))),s.a.createElement(h.a,{className:"pt-5 h-50"},s.a.createElement(p.a,{md:{span:8,offset:2}},s.a.createElement(x.a,{className:"authForm"},s.a.createElement(x.a.Group,{controlId:"username"},s.a.createElement(x.a.Label,null,"Your Username"),s.a.createElement(x.a.Control,{"data-inputtype":"userName",type:"text",placeholder:"User123",onChange:this.inputHandler,value:this.state.userName})),s.a.createElement(x.a.Group,{controlId:"password"},s.a.createElement(x.a.Label,null,"Your Password"),s.a.createElement(x.a.Control,{"data-inputtype":"password",type:"password",placeholder:"UnexpectedlyHardPassword",onChange:this.inputHandler,value:this.state.password}))))),s.a.createElement(h.a,{className:"buttonRow mt-5 pt-5"},s.a.createElement(p.a,{md:{span:3,offset:1},lg:{span:2,offset:1}},s.a.createElement(A.a,{variant:"outline-secondary",className:"w-100 mw-100",onClick:this.login},"Log in")),s.a.createElement(p.a,{md:{span:3,offset:4},lg:{span:2,offset:6},onClick:this.register},s.a.createElement(A.a,{variant:"outline-secondary",className:"w-100 mw-100"},"Register"))))))}}]),a}(s.a.Component)),F=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).setCredentials=n.setCredentials.bind(Object(o.a)(n)),n.state={isLoggedIn:!1,credentials:{}},n}return Object(i.a)(a,[{key:"setCredentials",value:function(e){this.setState({isLoggedIn:!0,credentials:e})}},{key:"render",value:function(){var e="";return e=this.state.isLoggedIn?s.a.createElement(I,{credentials:this.state.credentials}):s.a.createElement(P,{setCredentials:this.setCredentials}),s.a.createElement(s.a.Fragment,null,e)}}]),a}(s.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(s.a.createElement(F,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},70:function(e,t,a){e.exports=a(116)},75:function(e,t,a){},76:function(e,t,a){}},[[70,1,2]]]);
//# sourceMappingURL=main.e227f6c3.chunk.js.map